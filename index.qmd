---
title: "CEVE 543 Fall 2025 Lab 9: HMM and NHMM Implementation"
subtitle: "Hidden Markov Models for precipitation downscaling"
author: CEVE 543 Fall 2025
date: "2025-11-07"
type: "lab"
module: 2
week: 12
objectives:
  - "Fit Hidden Markov Model to observed precipitation data"
  - "Understand state assignments and parameter interpretation"
  - "Explore non-homogeneous HMM extensions for nonstationarity"
  - "Validate HMM fit and assess model performance"
ps_connection: "Builds HMM implementation and interpretation skills for PS2 Part 3"

engine: julia

format:
  html:
    toc: true
    toc-depth: 2
    code-block-bg: "#f8f8f8"
    code-block-border-left: "#e1e4e5"
    theme: simplex
    number-sections: true
    fig-format: svg
  typst:
    fontsize: 11pt
    margin: 
      x: 1in
      y: 1in
    number-sections: true
    fig-format: svg

execute: 
  cache: true
  freeze: auto

# Code formatting options
code-overflow: wrap
code-line-numbers: false
code-block-font-size: "0.85em"
---

## Objectives

1. Fit Hidden Markov Model to observed precipitation data
1. Understand state assignments and parameter interpretation
1. Explore non-homogeneous HMM extensions for nonstationarity
1. Validate HMM fit and assess model performance

## Before

::: {.callout-important}
## Instructions

Do this before the lab date so that lab itself can go more smoothly.
:::

## Background and Reading

<!-- Content will be added here -->

## Tasks

Modify the code section below to address the following tasks.

1. Fit 2-state Hidden Markov Model to daily precipitation data
1. Interpret HMM states and parameters in terms of weather conditions
1. Extend to non-homogeneous HMM with time-varying transition probabilities
1. Validate model fit using statistical tests and visualizations

## Code

```{julia}
#| output: false
using Pkg
lab_dir = dirname(@__FILE__)
Pkg.activate(lab_dir)
# Pkg.instantiate() # uncomment this the first time you run the lab to install packages, then comment it back
```

