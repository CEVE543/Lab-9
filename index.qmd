---
title: "Lab 9: Quantile Mapping Implementation"
subtitle: "Empirical and parametric quantile mapping, bias correction validation, correlation preservation challenges"
author: CEVE 543 Fall 2025
date: "2025-10-31"
type: "lab"
module: 2
week: 11
objectives:
  - "Implement empirical and parametric quantile mapping"
  - "Apply bias correction to temperature and precipitation"
  - "Validate bias correction methods statistically"
  - "Understand correlation preservation challenges"
  - "Force hydrological models with bias-corrected climate data"
ps_connection: "Builds quantile mapping tools for PS2 Task 4 (implementing bias correction and assessing improvements in streamflow projections)"

engine: julia

format:
  html:
    toc: true
    toc-depth: 2
    code-block-bg: "#f8f8f8"
    code-block-border-left: "#e1e4e5"
    theme: simplex
    number-sections: true
    fig-format: svg
  typst:
    fontsize: 11pt
    margin: 
      x: 1in
      y: 1in
    number-sections: true
    fig-format: svg

execute: 
  cache: true
  freeze: auto

# Code formatting options
code-overflow: wrap
code-line-numbers: false
code-block-font-size: "0.85em"
---

## Objectives

1. Implement empirical and parametric quantile mapping
1. Apply bias correction to temperature and precipitation for hydrological modeling
1. Validate bias correction methods statistically
1. Understand correlation preservation challenges

## Before

::: {.callout-important}
## Instructions

Do this before the lab date so that lab itself can go more smoothly.
:::

## Background and Reading

<!-- Content will be added here -->

## Tasks

Modify the code section below to address the following tasks.

1. Implement both empirical and parametric quantile mapping approaches
1. Apply bias correction to temperature and precipitation data
1. Validate bias correction methods using statistical assessments
1. Force hydrological models with bias-corrected climate data and assess performance

## Code

